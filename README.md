# orb-artifactory

CircleCI Orb created in partnership with jFrog.

## Features

This orb will support the major features of the [JFrog CLI](https://www.jfrog.com/confluence/display/CLI/CLI+for+JFrog+Artifactory)

To limit the permutations of variables, advanced use cases must pass a [`specs` file.](https://www.jfrog.com/confluence/display/CLI/CLI+for+JFrog+Artifactory#CLIforJFrogArtifactory-UsingFileSpecs)

### Jobs

- Upload - installs and configures CLI before calling upload command.

#### Upload Job Example

Uploading a .jar file created with maven
```
version: 2.1
workflows:
  version: 2
  publish:
    jobs:
      - artifactory/upload:
          name: Publish Maven Jar
          build-steps:
            - run: mvn install -B
          source: test/artifact.jar
          target: repo/path
```


### Commands

- Upload - upload assets using `source` and `target` arguments
- Install - install JFrog CLI if not present
- Configure - configure CLI to use `ARTIFACTORY_URL` and `ARTIFACTORY_API_KEY` for all interactions

#### Custom CLI Command Example
Install CLI and upload environment info.
```
version: 2.1
jobs:
  build:
    docker:
    - image: circleci/node:10
    working_directory: ~/repo
    steps:
    - checkout
    - artifactory/install
    - run:
        command: |
          jfrog rt bce my-build ${CIRCLE_BUILD_NUM}
```

## Testing
Currently using BATS to test output generated by our orb.  
`bats tests/config_tests.bats`

### Testing against published orb
An optional env var `$BATS_IMPORT_DEV_ORB` can reference the full path of a published orb to test resolution against.  See [config.yml](.circleci/config.yml) for example.

### More on BATS
See [BATS project](https://github.com/bats-core/bats-core) for usage and more.

### Orbs Authoring / Contributing
See https://github.com/CircleCI-Public/config-preview-sdk/blob/master/docs/getting-started.md
