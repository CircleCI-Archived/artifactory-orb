description: >
  Use the `docker-publish` job to build and tag a Docker image, then
  push it to a JFrog Docker registry and promote it.

usage:
  version: 2.1

  orbs:
    artifactory: circleci/artifactory@1.0.0

  workflows:
    simple-docker-example:
      jobs:
        - artifactory/install
        - artifactory/configure
        - artifactory/docker-publish:
            name: Docker Publish Simple
            docker-registry: orbdemos-docker-local.jfrog.io
            repository: docker-build
            docker-tag: orbdemos-docker-local.jfrog.io/hello-world:1.0-${CIRCLE_BUILD_NUM}
        - artifactory/promote:
            name: Promote a build
            build-name: "hello-world"
            build-number: "1.0-${CIRCLE_BUILD_NUM}"
            taget: docker-local
