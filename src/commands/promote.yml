description: >
  Promote assets on Artifactory via `jfrog rt build-promote`. For details, see
  https://jfrog.com/confluence/display/CLI/CLI+for+JFrog+Artifactory#CLIforJFrogArtifactory-UploadingFiles

parameters:
  comment:
    type: string
    default: ""
    description: >
      Optional comment for the promoted build.

  status:
    type: string
    default: ""
    description: >
      Optional status for the promoted build.

  target:
    type: string
    default: ""
    description: >
      Target path in Artifactory for uploads, in the following format:
      [repository_name]/[repository_path]

  build-name:
    type: string
    default: ${CIRCLE_PROJECT_REPONAME}
    description: >
      Artifactory build name, defaults to the value of
      $CIRCLE_PROJECT_REPONAME

  build-number:
    type: string
    default: ${CIRCLE_BUILD_NUM}
    description: >
      Artifactory build number, defaults to the value of $CIRCLE_BUILD_NUM

steps:
  - run:
      name: Promote assets with JFrog CLI
      command: |
        jfrog rt build-promote \
          <<#parameters.comment>>--comment "<<parameters.comment>>"<</parameters.comment>> \
          <<#parameters.status>>--status "<<parameters.status>>"<</parameters.status>> \
          <<parametes.build-name>> \
          <<parameters.build-number>> \
          <<parameters.target>>
